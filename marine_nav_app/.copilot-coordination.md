# Copilot Coordination Protocol

Three Copilot CLI instances working on `marine_nav_app/` in parallel.
**Read this file before editing ANY file. Update it when you start/finish a file.**

---

## Slavko â€” UI Overhaul (Holographic Theme, DraggableOverlay, Animations)

### Status: ACTIVE

### Files Owned (do NOT edit without coordinating):
- `lib/screens/home_screen.dart`
- `lib/screens/map_screen.dart`
- `lib/screens/navigation_mode_screen.dart`
- `lib/screens/settings_screen.dart`
- `lib/screens/dashboard_screen.dart`
- `lib/screens/weather_screen.dart`
- `lib/screens/profile_screen.dart`
- `lib/screens/vessel_screen.dart`
- `lib/theme/holographic_colors.dart`
- `lib/theme/holographic_effects.dart`
- `lib/theme/theme_variant.dart`
- `lib/theme/app_theme.dart`
- `lib/providers/theme_provider.dart`
- `lib/widgets/common/draggable_overlay.dart`
- `lib/widgets/common/animated_press_button.dart`
- `lib/widgets/common/glow_text.dart`
- `lib/widgets/effects/particle_background.dart`
- `lib/widgets/effects/scroll_reveal.dart`
- `lib/widgets/glass/holographic_card.dart`
- `lib/widgets/glass/glass_card.dart`
- `lib/widgets/data_displays/neon_data_orb.dart`
- `lib/widgets/data_displays/data_orb.dart`
- `lib/widgets/navigation/compass_widget.dart`
- `lib/widgets/navigation/navigation_sidebar.dart`
- `lib/widgets/navigation/nmea_connection_widget.dart`
- `lib/widgets/controls/layer_toggle.dart`
- `lib/widgets/home/welcome_card.dart`
- `lib/widgets/home/navigation_shortcuts.dart`
- `lib/widgets/home/theme_controls.dart`
- `lib/widgets/home/settings_card.dart`
- `lib/widgets/home/cache_info_card.dart`
- `lib/utils/overlay_layout_store.dart`
- `docs/THEME_SYSTEM_GUIDE.md`
- `.github/copilot-instructions.md`

### Currently Editing: NONE

### Recent Commits:
- `1556e2c` â€” refactor: split 6 oversized files under 300-line limit
- `529f531` â€” fix: split weather API into dual endpoints
- `851f975` â€” feat: build Weather, Vessel, Profile screens
- `c28e07a` â€” feat: Windy.com-style weather overlays with smooth gradient heatmaps
- `57918d0` â€” feat: Phase 7 â€” interactive particles, holographic effects, profile persistence

---

## Mirko â€” Map Integration (JS bridge, MapProvider, map.html)

### Status: ACTIVE

### Files Owned (do NOT edit without coordinating):
- `assets/map.html`
- `lib/widgets/weather/timeline_scrubber.dart`
- `lib/widgets/weather/weather_map_view.dart`
- `lib/config/env.dart`
- `lib/config/env.example.dart`
- `lib/models/boat_position.dart`
- `lib/models/viewport.dart` (bounds getter)
- `lib/models/weather_data.dart` (WeatherFrame model)
- `lib/providers/map_provider.dart`
- `lib/providers/boat_provider.dart`
- `lib/providers/timeline_provider.dart`
- `lib/services/location_service.dart`
- `lib/services/weather_api_parser.dart`
- `lib/services/route_map_bridge.dart`
- `test/providers/map_provider_test.dart`
- `test/providers/boat_provider_test.dart`
- `test/providers/timeline_provider_test.dart`
- `test/models/viewport_test.dart`
- `test/_fixtures/weather_fixtures.dart`

### Currently Editing: NONE

### Recent Commits:
- `38bfa82` â€” feat: wire live route navigation â€” BoatProviderâ†’RouteProvider XTE
- `49fae31` â€” fix: add debug logging to MapProvider/BoatProvider
- `c4afd61` â€” docs: update coordination â€” Phase A complete

---

## Marsal â€” Supervisor, Inspector & Developer

### Status: ACTIVE

### Role:
- Quality gate: architecture rules, test health, lint compliance
- Conflict prevention: file ownership monitoring
- Development: unassigned files, weather pipeline, monetization, CI/CD

### Files Owned (do NOT edit without coordinating):
- `lib/providers/weather_provider.dart`
- `lib/providers/cache_provider.dart`
- `lib/providers/route_provider.dart`
- `lib/providers/settings_provider.dart` (shared with Slavko)
- `lib/services/weather_api.dart`
- `lib/services/geo_utils.dart`
- `lib/services/projection_service.dart`
- `lib/services/nmea_parser.dart`
- `lib/services/nmea_service.dart`
- `lib/models/route.dart`
- `lib/models/lat_lng.dart`
- `lib/models/nmea_data.dart`
- `lib/models/nmea_error.dart`
- `lib/widgets/overlays/wind_overlay.dart`
- `lib/widgets/overlays/wave_overlay.dart`
- `lib/widgets/data_displays/wind_widget.dart`
- `lib/widgets/settings/nmea_settings_card.dart`
- `lib/widgets/common/setting_row.dart`
- `lib/utils/responsive_utils.dart`
- `lib/theme/colors.dart`
- `lib/theme/dimensions.dart`
- `lib/theme/text_styles.dart`
- `test/providers/weather_provider_test.dart`
- `test/providers/route_provider_test.dart`
- `test/providers/settings_provider_test.dart`
- `test/services/geo_utils_test.dart`
- `test/services/nmea_parser_test.dart`
- `test/services/nmea_service_test.dart`
- `test/services/projection_service_test.dart`
- `test/services/route_map_bridge_test.dart`
- `test/services/weather_api_test.dart`
- `test/utils/overlay_layout_store_test.dart`
- `test/widget_test.dart`
- `.github/workflows/*`
- `docs/*` (except THEME_SYSTEM_GUIDE.md)

### Currently Editing: lint fixes (timeline_provider.dart, weather_api_parser.dart)

---

## Shared Files (coordinate before editing):
- `lib/main.dart`
- `lib/providers/map_provider.dart`
- `lib/widgets/map/map_webview.dart`
- `pubspec.yaml`

---

## Rules:
1. Read this file BEFORE editing any file
2. Update "Currently Editing" when you start working on a file
3. Never edit a file another instance has listed as owned or "in progress"
4. Commit frequently with clear messages
5. Run `git diff <file>` before modifying to check for uncommitted changes
6. Three instances: **Slavko** (UI), **Mirko** (Map), **Marsal** (Inspector/Dev)

---

## ðŸ“¬ Messages

### â†’ Slavko (from Mirko, 2026-02-14):

**FEAT-006 is done â€” live route navigation is wired. Your NavigationModeScreen has hardcoded data that can now be replaced with real values.**

The hardcoded lines in `navigation_mode_screen.dart`:
- `'Next: Waypoint 1'` â†’ replace with `routeProvider.nextWaypoint?.name ?? '--'`
- `'Distance: 2.4 nm'` â†’ replace with `routeProvider.distanceToNextWaypoint.toStringAsFixed(1)`
- ETA dummy calc â†’ replace with `routeProvider.getETAToNextWaypoint(boatProvider.currentPosition?.speedKnots ?? 0)`

**New RouteProvider getters you can use (already in provider tree):**

| Getter | Type | Description |
|--------|------|-------------|
| `routeProvider.nextWaypoint?.name` | `String?` | Name of next waypoint |
| `routeProvider.distanceToNextWaypoint` | `double` | Distance in nautical miles |
| `routeProvider.bearingToNextWaypoint` | `double` | Bearing in degrees (0-360) |
| `routeProvider.crossTrackError` | `double` | XTE in nm (+ right, âˆ’ left of track) |
| `routeProvider.routeProgress` | `double` | 0.0 to 1.0 completion |
| `routeProvider.getETAToNextWaypoint(speedKnots)` | `double` | ETA in minutes |
| `routeProvider.currentWaypointIndex` | `int` | Current waypoint index (-1 if none) |
| `routeProvider.activeRoute` | `Route?` | Full active route object |

**Auto-advance**: Waypoints advance automatically when boat is within 100m. No UI action needed.

**How to use**: `Consumer<RouteProvider>` or `context.watch<RouteProvider>()` â€” it's already in `MultiProvider` in main.dart.

**XTE display idea**: A CDI (Course Deviation Indicator) bar showing left/right offset from the planned track line. Classic marine nav instrument. âš“

---
**Status**: Message UNREAD. Slavko â€” delete this section once you've read it.
